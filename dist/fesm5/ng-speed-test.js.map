{"version":3,"file":"ng-speed-test.js","sources":["ng://ng-speed-test/services/speed-test.service.ts","ng://ng-speed-test/main.ts","ng://ng-speed-test/ng-speed-test.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\n\nimport {Observable} from 'rxjs';\n\n@Injectable()\nexport class SpeedTestService {\n  constructor() {\n\n  }\n\n  getSpeed():Observable<string|boolean> {\n    return new Observable(\n      (observer) => {\n        window.setTimeout(\n          () => {\n            const imageAddr = 'https://webapp.uic-chp.org/internet-speed-image.jpg';\n\n            let startTime, endTime;\n            const download = new Image();\n\n            download.onload = () => {\n              endTime = (new Date()).getTime();\n\n              const downloadSize = 4995374;\n\n              const duration = (endTime - startTime) / 1000;\n\n              const bitsLoaded = downloadSize * 8;\n\n              const speedBps:any = (bitsLoaded / duration).toFixed(2);\n              const speedKbps:any = (speedBps / 1024).toFixed(2);\n\n              const speedMbps = (speedKbps / 1024).toFixed(2);\n\n              observer.next(speedMbps);\n              observer.complete();\n            };\n\n            download.onerror = () => {\n              observer.next(false);\n              observer.complete();\n            };\n\n            startTime = (new Date()).getTime();\n\n            const cacheBuster = '?nnn=' + startTime;\n            download.src = imageAddr + cacheBuster;\n          },\n          1\n        );\n      }\n    );\n  }\n}\n","import {NgModule, ModuleWithProviders} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {FormsModule} from '@angular/forms';\n\nimport {SpeedTestService} from './services/speed-test.service';\n\nexport * from './services/speed-test.service';\n\n@NgModule({\n  providers: [\n    SpeedTestService\n  ],\n  imports: [\n    CommonModule,\n    FormsModule\n  ]\n})\nexport class NgSpeedTestModule {\n  static forRoot():ModuleWithProviders {\n    return {\n      ngModule: NgSpeedTestModule,\n      providers: []\n    };\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './main';\n"],"names":[],"mappings":";;;;;;;IAME;KAEC;IAED,mCAAQ,GAAR;QACE,OAAO,IAAI,UAAU,CACnB,UAAC,QAAQ;YACP,MAAM,CAAC,UAAU,CACf;gBACE,IAAM,SAAS,GAAG,qDAAqD,CAAC;gBAExE,IAAI,SAAS,EAAE,OAAO,CAAC;gBACvB,IAAM,QAAQ,GAAG,IAAI,KAAK,EAAE,CAAC;gBAE7B,QAAQ,CAAC,MAAM,GAAG;oBAChB,OAAO,GAAG,CAAC,IAAI,IAAI,EAAE,EAAE,OAAO,EAAE,CAAC;oBAEjC,IAAM,YAAY,GAAG,OAAO,CAAC;oBAE7B,IAAM,QAAQ,GAAG,CAAC,OAAO,GAAG,SAAS,IAAI,IAAI,CAAC;oBAE9C,IAAM,UAAU,GAAG,YAAY,GAAG,CAAC,CAAC;oBAEpC,IAAM,QAAQ,GAAO,CAAC,UAAU,GAAG,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;oBACxD,IAAM,SAAS,GAAO,CAAC,QAAQ,GAAG,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;oBAEnD,IAAM,SAAS,GAAG,CAAC,SAAS,GAAG,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;oBAEhD,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;oBACzB,QAAQ,CAAC,QAAQ,EAAE,CAAC;iBACrB,CAAC;gBAEF,QAAQ,CAAC,OAAO,GAAG;oBACjB,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;oBACrB,QAAQ,CAAC,QAAQ,EAAE,CAAC;iBACrB,CAAC;gBAEF,SAAS,GAAG,CAAC,IAAI,IAAI,EAAE,EAAE,OAAO,EAAE,CAAC;gBAEnC,IAAM,WAAW,GAAG,OAAO,GAAG,SAAS,CAAC;gBACxC,QAAQ,CAAC,GAAG,GAAG,SAAS,GAAG,WAAW,CAAC;aACxC,EACD,CAAC,CACF,CAAC;SACH,CACF,CAAC;KACH;IA/CU,gBAAgB;QAD5B,UAAU,EAAE;OACA,gBAAgB,CAgD5B;IAAD,uBAAC;CAhDD;;;ICYA;KAOC;0BAPY,iBAAiB;IACrB,yBAAO,GAAd;QACE,OAAO;YACL,QAAQ,EAAE,mBAAiB;YAC3B,SAAS,EAAE,EAAE;SACd,CAAC;KACH;;IANU,iBAAiB;QAT7B,QAAQ,CAAC;YACR,SAAS,EAAE;gBACT,gBAAgB;aACjB;YACD,OAAO,EAAE;gBACP,YAAY;gBACZ,WAAW;aACZ;SACF,CAAC;OACW,iBAAiB,CAO7B;IAAD,wBAAC;CAPD;;ACjBA;;GAEG;;;;"}