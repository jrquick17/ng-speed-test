{"version":3,"file":"ng-speed-test.js","sources":["ng://ng-speed-test/app/models/file-details.model.ts","ng://ng-speed-test/app/models/speed-details.model.ts","ng://ng-speed-test/app/services/speed-test.service.ts","ng://ng-speed-test/app/speed-test.module.ts","ng://ng-speed-test/ng-speed-test.ts"],"sourcesContent":["export class FileDetailsModel {\n  public path:string;\n  public shouldBustCache:boolean = true;\n  public size:number;\n\n  constructor() {\n\n  }\n}\n","export class SpeedDetailsModel {\n  public duration:number;\n  public endTime:number;\n  public speedBps:number;\n  public startTime:number;\n\n  constructor(\n    private fileSize:number\n  ) {\n\n  }\n\n  end():void {\n    this.endTime = (new Date()).getTime();\n\n    this.duration = (this.endTime - this.startTime) / 1000;\n\n    const bitsLoaded = this.fileSize * 8;\n\n    this.speedBps = bitsLoaded / this.duration;\n  }\n\n  start():void {\n    this.startTime = (new Date()).getTime();\n  }\n}\n","import {Injectable} from '@angular/core';\n\nimport {Observable, Subscriber} from 'rxjs';\nimport {map} from 'rxjs/operators';\nimport {FileDetailsModel} from '../models/file-details.model';\nimport {SpeedDetailsModel} from '../models/speed-details.model';\n\n@Injectable()\nexport class SpeedTestService {\n  constructor() {\n\n  }\n\n  private _applyCacheBuster = (path:string): string => path + '?nnn=' + Math.random();\n\n  getBps(fileDetails?:FileDetailsModel, iterations?:number):Observable<number|null> {\n    return new Observable(\n      (observer) => {\n        window.setTimeout(\n          () => {\n            let filePath = 'https://ng-speed-test.jrquick.com/assets/1mb.jpg';\n            let fileSize = 1197292;\n            let shouldBustCache = true;\n\n            // 408949 // 500kb\n            // 1197292 // 1mb\n            // 4952221 // 5mb\n            // 13848150 // 15mb\n\n            if (typeof fileDetails !== 'undefined') {\n              if (typeof fileDetails.path === 'undefined') {\n                console.error('ng-speed-test: File path is missing.');\n              } else {\n                filePath = fileDetails.path;\n              }\n\n              if (typeof fileDetails.shouldBustCache !== 'undefined') {\n                shouldBustCache = fileDetails.shouldBustCache === true;\n              }\n\n              if (typeof fileDetails.size === 'undefined') {\n                console.error('ng-speed-test: File size is missing.');\n              } else {\n                fileSize = fileDetails.size;\n              }\n            }\n\n            if (shouldBustCache) {\n              filePath = this._applyCacheBuster(filePath);\n            }\n\n            if (typeof iterations === 'undefined') {\n              iterations = 1;\n            }\n\n            const speedDetails = new SpeedDetailsModel(fileSize);\n\n            const download = new Image();\n\n            download.onload = (a) => {\n              speedDetails.end();\n\n              observer.next(speedDetails.speedBps);\n              observer.complete();\n            };\n\n            download.onerror = () => {\n              observer.next(null);\n              observer.complete();\n            };\n\n            speedDetails.start();\n\n            download.src = filePath;\n          },\n          1\n        );\n      }\n    );\n  }\n\n  getKbps():Observable<number> {\n    return this.getBps().pipe(\n      map(\n        (bps) => {\n          return bps / 1024;\n        }\n      )\n    );\n  }\n\n  getMbps():Observable<number> {\n    return this.getKbps().pipe(\n      map(\n        (kpbs) => {\n          return kpbs / 1024;\n        }\n      )\n    );\n  }\n}\n","import {NgModule} from '@angular/core';\n\nimport {SpeedTestService} from './services/speed-test.service';\n\n@NgModule({\n  providers: [\n    SpeedTestService\n  ]\n})\nexport class SpeedTestModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './main';\n"],"names":[],"mappings":"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"}